<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Jul 16, 2012
 | Rendered using Apache Maven Fluido Skin 1.2.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cube Project - Cube Project Home Page</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido.min.js"></script>

    
      <meta name="author" content="Bassem Debbabi" />
    <meta name="Date-Revision-yyyymmdd" content="20120716" />
    <meta http-equiv="Content-Language" content="en" />
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../index.html" id="bannerLeft">
                                                                                                <img src="../images/cube.png"  alt="Cube Project"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="projectVersion">Version: 1.2</li>
              
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2012-07-16</li> 
            
                            </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                                    <h3>Project Links</h3>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Home">Home</a>
            </li>
                  <li class="none">
                          <a href="../1.2/getting_started.html" title="Getting started">Getting started</a>
            </li>
                  <li class="none">
                          <a href="../1.2/doc.html" title="Documentation">Documentation</a>
            </li>
                  <li class="none">
                          <a href="../download.html" title="Download">Download</a>
            </li>
                  <li class="none">
                          <a href="../license.html" title="License">License</a>
            </li>
          </ul>
                        <h3>Catalog</h3>
                  <ul>
                  <li class="none">
                          <a href="../1.2/managed_elements.html" title="Managed Elements">Managed Elements</a>
            </li>
                  <li class="none">
                          <a href="../1.2/constraints.html" title="Constraints">Constraints</a>
            </li>
                  <li class="none">
                          <a href="../1.2/extensions.html" title="Extensions">Extensions</a>
            </li>
          </ul>
                        <h3>Other Links</h3>
                  <ul>
                  <li class="none">
                          <a href="http://cube.imag.fr/wiki" class="externalLink" title="Wiki">Wiki</a>
            </li>
          </ul>
                      
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span10" >
                                  
            <p><a href="./getting_started.html">Getting started</a> &gt;</p><div class="section"><h2>Scopes constitution<a name="Scopes_constitution"></a></h2><p>In this tutorial, we will show you how the Cube agents are organized on scopes dynamically at runtime.</p><p>The actual implementation is based on a central <b>master</b> node which act as an index to the different scope leaders.</p><ul><li><a href="#Where_to_find_and_test_the_examples">Where to find and test the examples</a></li><li><a href="#The_final_result">The final result</a></li><li><a href="#The_Archetype">The Archetype</a></li><li><a href="#Cube_Agent_local_configs">Cube Agent local configs</a></li><li><a href="#Running_the_example">Running the example</a></li><li><a href="#Introspecting_the_Runtime_Model">Introspecting the Runtime Model</a></li></ul><div class="section"><h3>Where to find and test the examples<a name="Where_to_find_and_test_the_examples"></a></h3><p>From the <a href="../download.html">downloaded</a> distribution of Cube in the following directory:</p><div><pre>demo/getting_started/scopes</pre></div></div><div class="section"><h3>The final result<a name="The_final_result"></a></h3><p>We want to have the following virtual organization.</p><img src="./images/getting_started_scopes.png" alt="Virtual Scopes organization" /><p>We have one master node <tt>node0</tt> which is just an index to the different scope leaders, and a set of nodes organized on scopes. We have two types of scopes <tt>BlueVirtualScope</tt> and <tt>GreenVirdualScope</tt>. You notice in the picture that there is two instances of the same type &quot;GreenVirtualScope&quot;. </p></div><div class="section"><h3>The Archetype<a name="The_Archetype"></a></h3><p>In this tutorial, we will have no constraints on nodes or components, but just the definition of the different scopes and nodes types, and the initial configuration of each cube agent.</p><p>Here is the correspondent archetype file located on:</p><div><pre>demo/getting_started/scopes/demo.arch</pre></div><div class="source"><pre class="prettyprint">&lt;cube xmlns:core=&quot;fr.liglab.adele.cube.core&quot;&gt;
  &lt;archetype id=&quot;net.debbabi.cube.demo.scopes&quot; name=&quot;Scopes tutorial&quot; version=&quot;1.0&quot;&gt;

    &lt;types&gt;
      &lt;core:scope id=&quot;BlueVirtualScope&quot;/&gt;
      &lt;core:scope id=&quot;GreenVirtualScope&quot;/&gt;
      &lt;core:node id=&quot;PC&quot;/&gt;
    &lt;/types&gt;

    &lt;constraints&gt;
    &lt;/constraints&gt;

    &lt;global-configs&gt;                    
      &lt;core:topscopeleader url=&quot;cube://localhost:38000&quot;/&gt;
    &lt;/global-configs&gt;

  &lt;/archetype&gt;
&lt;/cube&gt;</pre></div><p>We have specified the aforementioned two scope types and one node type &quot;PC&quot;. Notice, that we have also added the global config <tt>topscopeleader</tt> with which we specify the URL of the &quot;master&quot; node (it is <tt>node0</tt> in our example).</p></div><div class="section"><h3>Cube Agent local configs<a name="Cube_Agent_local_configs"></a></h3><p>Before launching the different nodes, have a look to the agent local config file for each node.</p><div><pre>demo/getting_started/scopes/node1/load/cube.agent</pre></div><div class="source"><pre class="prettyprint">&lt;cube&gt;
  &lt;agent&gt;
    &lt;host value=&quot;localhost&quot;/&gt;
    &lt;port value=&quot;38001&quot;/&gt;
    &lt;archetypeUrl value=&quot;file:../demo.arch&quot;/&gt;
    &lt;debug value=&quot;false&quot;/&gt;

    &lt;extensions&gt;
      &lt;extension id=&quot;fr.liglab.adele.cube.core&quot;&gt;
        &lt;configurations&gt;
          &lt;initializer&gt;                           
            &lt;set-node id=&quot;node1&quot; type=&quot;PC&quot;/&gt;
            &lt;set-scope id=&quot;gvs1&quot; type=&quot;GreenVirtualScope&quot;/&gt;
          &lt;/initializer&gt;
        &lt;/configurations&gt;
      &lt;/extension&gt;                      
    &lt;/extensions&gt;
  &lt;/agent&gt;
&lt;/cube&gt;</pre></div><p>In this configuration file we have general information about the host/port and the url of the archetype to be used. There is also a list of extension to be used by the agent. Here in this example, we use the core extension which manages the core model elements (scopes, nodes and components). We configure this core extension to initialize the node and scope objects with the given types.</p><p>See <a href="./agent.html">Cube Agent Documentation</a> for further information.</p></div><div class="section"><h3>Running the example<a name="Running_the_example"></a></h3><p>To start a node, go to its corresponding directory and type the following command under linux (other OS launching scripts will be available <a class="externalLink" href="https://github.com/AdeleResearchGroup/cube/issues/1">as soon as possible</a>) :</p><div><pre>  $ sh ./init.sh
      _______              
     /|      |             
    | | CUBE |...Starting the CUBE Platform  
    | |______|   1.2.0-SNAPSHOT
    |/______/              
  
  ____________________________
  Welcome to Apache Felix Gogo

  [INFO] ... starting the CubeAgent: cube://localhost:38000
  g! 
</pre></div><p>Start the different nodes progressivelly. The following commands help to understand what hapens and to see the different created scopes and affectation of the their scope leaders (see the list of all available <a href="./commandline.html">commands</a>).</p><ul><li><b>exts</b><p>This command shows the differents running extension of the cube agent. In this example it will shows only the core extension:</p><div><pre>  g! exts
  --------------------------------------------------------------------------
  - fr.liglab.adele.cube.core:1.2.0-SNAPSHOT
  --------------------------------------------------------------------------
  g! </pre></div></li><li><b>ext extension_id</b><p>This commend shows the derail of the chosen extension. The core extension shows the different scopes. When running this command on the <tt>node0</tt>, it gives the following output:</p><div><pre>  g! ext fr.liglab.adele.cube.core:1.2.0-SNAPSHOT
        --------------------------------------------------------------------------
        + CoreExtension
  + scopes.management
    - top.scope.leader.url: cube://localhost:38000/fr.liglab.adele.cube.core/topscopeleader
    - is.top.scope.leader: true
      - GreenVirtualScope | gvs1 | cube://localhost:38001/fr.liglab.adele.cube.core/scopeleader
      - BlueVirtualScope | bvs1 | cube://localhost:38003/fr.liglab.adele.cube.core/scopeleader
      - GreenVirtualScope | gvs2 | cube://localhost:38005/fr.liglab.adele.cube.core/scopeleader

        --------------------------------------------------------------------------
  g! </pre></div><p>You notice that this <tt>node0</tt> &quot;is.top.scope.leader&quot;, and its internal index contains URLs of the different scope leaders, namely <tt>node1</tt> scope leader of <tt>gvs1</tt>, <tt>node3</tt> scope leader of <tt>bvs1</tt> and <tt>node5</tt> scope leader of <tt>gvs2</tt>.</p><p>However, when running the previous command on the console of the <tt>node3</tt> for instance, it gives the following output:</p><div><pre>  g! ext fr.liglab.adele.cube.core:1.2.0-SNAPSHOT
        --------------------------------------------------------------------------
        + CoreExtension
  + scopes.management
    - top.scope.leader.url: cube://localhost:38000/fr.liglab.adele.cube.core/topscopeleader
    - is.top.scope.leader: false
    - scope.leader.url: cube://localhost:38003/fr.liglab.adele.cube.core/scopeleader
    - is.scope.leader: true
      - cube://localhost:38003/fr.liglab.adele.cube.core/scopeleader
      - cube://localhost:38004/fr.liglab.adele.cube.core/scopeleader

        --------------------------------------------------------------------------
  g! </pre></div><p>That is, as the <tt>node3</tt> is a scope leader for <tt>bvs1</tt> scope (of type BlueVirtualScope), it contains the list of the scope members; its self (URL: cube://localhost:38003) and <tt>node4</tt> (URL: cube://localhost:38004).</p><p><b>Note</b>: This output will be enhanced on future release of Cube framework!</p></li></ul></div><div class="section"><h3>Introspecting the Runtime Model<a name="Introspecting_the_Runtime_Model"></a></h3><p>The particularity of Cube is that all the concepts are available as abstract element instances at runtime. We can introspect theme, and in the next of this getting started tutorial, we will show how to put constraints on theme. All what hapen on the runtime model is applied to the real nodes, and vise versa.</p><p>On one of the running nodes (<tt>node1</tt> for instance), type the following command:</p><div><pre>  g! rm</pre></div><p>This will show the Runtime Model Part of the current agent.</p><div><pre>- cube://localhost:38001/objects/0 (fr.liglab.adele.cube.core.scope:GreenVirtualScope) [VALID]
        localId:gvs1
        NODES:

- cube://localhost:38001/objects/1 (fr.liglab.adele.cube.core.node:PC) [VALID]
        localId:node1
        COMPONENTS:
        SCOPES:</pre></div><p>You notice that we have two object instances, the one representing the scope and the second representing the node itself.</p><p><a href="./getting_started.html">Getting started</a> &gt;</p></div></div>
                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2012.
          All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
